<div class="general_form_wrapper">
  <%= simple_form_for(@person) do |f| %>
    <%= f.error_notification %>

    <div class="form-inputs">
      <legend>General Information</legend>
      <%= f.input :name %>
      <%= f.input :bio %>
      <%= f.input :gender %>
      <%= f.input :photo %>
      <legend>Digital Addresses</legend>
      <div class="">
        <table id="digital_address_table" class="full_width">
          <%= f.association :digital_addresses do |d_address| %>
            <tr>
              <td><%= d_address.input :url, label: false %></td>
              <td><%= d_address.collection_select(:address_type, DigitalAddress::address_types, :first, :last) %></td>
            </tr>
          <% end %>
        </table>
        <a id="add_web_button" onclick="return false;" class="btn btn-sm btn-default" href="">
        <div class="glyphicon glyphicon-plus"></div> Add Web Address</a>
      </div>
    </div>

    <div class="form-actions">
      <%= f.button :submit, :class => "btn btn-primary" %>
    </div>
  <% end %>
</div>

<script>
  // Add Digital Address Script
  $(document).ready(function(){
    var i = <%= @person.digital_addresses.count %>;
    var options = '<%= raw options_from_collection_for_select(DigitalAddress.address_types, :first, :last).squish.gsub('> <', '><') %>';

    $("#add_web_button").click(function(){
      i ++;
      $("#digital_address_table").append('<tr id="digi_'+i+'""><td><div class="input url optional person_digital_addresses_url"><input class="string url optional" id="person_digital_addresses_attributes_'+i+'_url" name="person[digital_addresses_attributes]['+i+'][url]" type="url" value="http://"></div></td><td><select id="person_digital_addresses_attributes_'+i+'_address_type" name="person[digital_addresses_attributes]['+i+'][address_type]">' + options + '</select></td><td><div class="remove_column">x</div></td></tr>');
    });
  });

  // Remove Row Script
  $(document).ready(function(){
    $('table').on('click', '.remove_column', function(e){
       $(this).closest('tr').remove()
    })
   });
</script>
